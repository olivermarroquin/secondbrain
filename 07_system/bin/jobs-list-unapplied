#!/usr/bin/env python3
import json, pathlib

def cut(s, n):
    s = s or ""
    return s if len(s) <= n else s[:n-1] + "â€¦"

root = pathlib.Path.home() / "secondbrain/01_projects/jobs"
rows = []

for jm in root.rglob("tracking/job-meta.json"):
    try:
        d = json.loads(jm.read_text())
    except Exception:
        continue
    if d.get("status") == "not_applied":
        rows.append((
            d.get("company",""),
            d.get("role_title",""),
            d.get("date_found",""),
            d.get("source","")
        ))

rows = sorted(rows)

print(f"{'#':>3}  {'COMPANY':20}  {'ROLE':35}  {'FOUND':10}  {'URL'}")
print("-"*110)

for i, (company, role, found, url) in enumerate(rows, 1):
    print(f"{i:>3}  {company:20}  {cut(role,35):35}  {found:10}  {cut(url,60)}")

print(f"\nTotal not_applied: {len(rows)}")
